{% import _self as formMacros %}
{% form_theme form 'group/form_errors.html.twig' %}

{% macro printParticipant(participant) %}
    <div class="participant">
        <div class="row">
            <div class="input-field col s4">
                {{ form_label(participant.name) }}
                {{ form_widget(participant.name, {'attr': {'class': 'validate'}}) }}
                {{ form_errors(participant.name) }}
            </div>
            <div class="input-field col s5">
                {{ form_label(participant.surname) }}
                {{ form_widget(participant.surname, {'attr': {'class': 'validate participant__surname'}}) }}
                {{ form_errors(participant.surname) }}
            </div>
            <div class="participant__button-wrapper col s2">
                <button class="participant__toggle-additional-button blue darken-3 btn hoverable" type="button">
                    More
                </button>
            </div>
            <div class="participant__button-wrapper col s1">
                <i class="participant__remove-button material-icons">
                    close
                </i>
            </div>
        </div>
        <div class="participant__additional">
            <div class="row">
                <div class="input-field col s6">
                    <div class="row">
                        <div class="col s10 participant__username-wrapper">
                            {{ form_label(participant.username) }}
                            {{ form_widget(participant.username, {'attr': {'class': 'validate participant__username'}}) }}
                            {{ form_errors(participant.username) }}
                        </div>
                        <div class="col s2 participant__button-wrapper">
                            <i class="participant__username-generate-button material-icons">
                                refresh
                            </i>
                        </div>
                    </div>
                </div>
                <div class="input-field col s6">
                    <div class="row">
                        <div class="col s10 participant__password-wrapper">
                            {{ form_label(participant.password) }}
                            {{ form_widget(participant.password, {'attr': {'class': 'validate participant__password'}}) }}
                            {{ form_errors(participant.password) }}
                        </div>
                        <div class="col s2 participant__button-wrapper">
                            <i class="participant__password-generate-button material-icons">
                                refresh
                            </i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s6">
                    {{ form_label(participant.address) }}
                    {{ form_widget(participant.address, {'attr': {'class': 'validate'}}) }}
                    {{ form_errors(participant.address) }}
                </div>
                <div class="input-field col s6">
                    {{ form_label(participant.email) }}
                    {{ form_widget(participant.email, {'attr': {'class': 'validate'}}) }}
                    {{ form_errors(participant.email) }}
                </div>
            </div>
            <div class="row">
                <div class="input-field col s4">
                    {{ form_label(participant.birthDate) }}
                    {{ form_widget(participant.birthDate, {'attr': {'class': 'validate datepicker'}}) }}
                    {{ form_errors(participant.birthDate) }}
                </div>
                <div class="input-field col s4">
                    {{ form_label(participant.phone) }}
                    {{ form_widget(participant.phone, {'attr': {'class': 'validate'}}) }}
                    {{ form_errors(participant.phone) }}
                </div>
                <div class="col s4">
                    {{ form_widget(participant.gender) }}
                    {{ form_label(participant.gender) }}
                    {{ form_errors(participant.gender) }}
                </div>
            </div>
        </div>
    </div>
{% endmacro %}

<div class="group-form row">
    {{ form_start(form, {'attr': {'class': 'col s12'}}) }}
    <div class="group-form__address row">
        <div class="input-field col s12">
            {{ form_label(form.address) }}
            {{ form_widget(form.address, {'attr': {'class': 'validate'}}) }}
            {{ form_errors(form.address) }}
        </div>
    </div>
    <div class="participants" data-prototype="{{ formMacros.printParticipant(form.participants.vars.prototype)|e('html_attr') }}">
        {% for participant in form.participants %}
            {{ formMacros.printParticipant(participant) }}
        {% endfor %}
    </div>
    <button class="group-form__add-button btn blue darken-3" type="button">
        Add participant
    </button>
    <div class="group-form__submit-button-wrapper">
        {{ form_widget(form.save, {'attr': {'class': 'group-form__submit-button btn blue darken-3'}}) }}
    </div>
    {{ form_end(form) }}
</div>